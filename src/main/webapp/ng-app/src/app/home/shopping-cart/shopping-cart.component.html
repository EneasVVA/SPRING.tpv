<button id="mobileMenuButton" fxHide fxShow.xs md-icon-button mdTooltip="Close" mdTooltipPosition="below" (click)="close()">
  <md-icon>subject</md-icon>
</button>
<div [fxLayout]="row">
  <div fxFlex="50">
    <h2>Cart</h2>
  </div>
  <div fxFlex="50">
    <button md-mini-fab color="warn" mdTooltip="Clear" mdTooltipPosition="below" (click)="clearCart()" [disabled]="cartProducts.length==0" id="clearCartButton">
      <md-icon>clear</md-icon>
    </button>
    <button id="openCalculatorButton" md-mini-fab color="primary" mdTooltip="Open calculator" mdTooltipPosition="below" (click)="openCalculator()">
      <md-icon>keyboard</md-icon>
    </button>
  </div>
</div>
<ngx-datatable
  fxHide.xs
  class="material"
  [messages]="{emptyMessage: 'The shopping cart is empty', totalMessage: 'products'}"
  [rowHeight]="'auto'"
  [columnMode]="'force'"
  [rows]="cartProducts"
  [reorderable]="false"
  [footerHeight]="50"
  [limit]="5"
  [columns]="columns">
  <ngx-datatable-column name="Description" [flexGrow]="3">
    <ng-template let-value="value" ngx-datatable-cell-template>
      {{value}}
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="Price" prop="retailPrice" [flexGrow]="2">
   <ng-template let-row="row" let-value="value" ngx-datatable-cell-template>
    {{row.retailPrice}}
  </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="NÂº" prop="amount" [flexGrow]="2">
    <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
      <input mdInput type="number" step="1" min="1" (blur)="updateProduct(row, $event, 'amount')" [value]="value"/>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="%" prop="discount" [flexGrow]="2">
    <ng-template ngx-datatable-cell-template let-value="value" let-row="row">
      <input mdInput type="number" step="0.01" min="0.00" max="100.00" (blur)="updateProduct(row, $event, 'discount')" [value]="roundDiscount(value)"/>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name="Total" prop="totalPrice" [flexGrow]="2">
    <ng-template ngx-datatable-cell-template let-row="row" >
        <input mdInput type="number" step="0.01" min="0.00" max="100.00" (blur)="updateTotalPrice(row, $event)" [value]="calculateProductTotal(row)"/>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column name=" " prop="delivered" [flexGrow]="2">
    <ng-template ngx-datatable-cell-template let-row="row" let-value="value">
      <md-checkbox (change)="updateProduct(row, $event, 'delivered')" [checked]="value" mdTooltip="Delivered" mdTooltipPosition="left"></md-checkbox>
      <button md-icon-button (click)="removeFromCart(row)" mdTooltip="Delete from cart" mdTooltipPosition="left">
        <md-icon class="md-24" color="warn">delete</md-icon>
      </button>
    </ng-template>
  </ngx-datatable-column>
</ngx-datatable>
<md-card fxHide fxShow.xs>
  <md-list *ngFor="let product of cartProducts">
    <md-list-item>
      <p>
      {{product.description}} (x{{product.amount}})
      </p>
      <p> 
        <md-input-container>
          <input mdInput type="number" step="0.01" min="0.00" max="100.00" [(ngModel)]="product.discount"/>
        </md-input-container>
      </p>
      <p>
        <md-checkbox [(ngModel)]="product.delivered" mdTooltip="Delivered" mdTooltipPosition="left"></md-checkbox> 
      </p>
      <p>
        <button md-icon-button (click)="removeFromCart(product)" mdTooltip="Delete from cart" mdTooltipPosition="left">
          <md-icon class="md-24" color="warn">delete</md-icon>
        </button>
      </p>
    </md-list-item>
    <md-divider></md-divider>
  </md-list>
</md-card>
<p>Total: <b id="totalPrice">{{totalPrice | currency:'EUR':true}}</b></p>
<div fxLayout="column" id="paddingContainer">
  <md-card >
    <form fxLayout="column" (ngSubmit)="onSubmit($event)" #cartForm="ngForm" class="center">
      <div class="form-group">
        Add product by code: 
        <md-input-container>
          <input mdInput type="number" placeholder="Product code" class="form-control" id="codeInput" required
          [(ngModel)]="codeInput" name="codeInput" #name="ngModel">
        </md-input-container>
      </div>
      <button md-raised-button color="primary" type="submit" [disabled]="!cartForm.form.valid" id="submitCodeInputButton">Submit</button>
    </form>
  </md-card>
  <md-card >
    <div class="form-group center" fxLayout="column" >
      <button md-raised-button color="accent" (click)="checkout()" [disabled]="cartProducts.length==0" id="checkoutButton">Check out</button>
    </div>
  </md-card>
</div>